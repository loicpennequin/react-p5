{"version":3,"sources":["components/SmileyFace/Eye.jsx","components/SmileyFace/Smile.jsx","components/SmileyFace/index.jsx","pages/SmileyFace.jsx","../../src/Command.jsx","../../src/utils/handleValueOrFunction.js","../../src/utils/handleCommonProps.js","../../src/PushPop.jsx","../../src/Debug.jsx","../../src/RenderContext.jsx","../../src/P5.jsx","../../src/Layer.jsx","../../src/Mask.jsx","../../src/Canvas.jsx","../../src/shapes/Rectangle.jsx","../../src/LinearGradient.jsx","../../src/Body.jsx","../../src/shapes/Arc.jsx","../../src/shapes/Background.jsx","../../src/shapes/Circle.jsx","../../src/shapes/Line.jsx"],"names":["Eye","position","x","y","size","showPupil","EYEBALL_SIZE","PUPIL_SIZE","handlePupilPosition","useMemo","getConstraint","p","radius","circle","createVector","result","map","mouseX","width","mouseY","height","dist","sub","setMag","add","generateCircleContraint","fill","noStroke","Mouth","start","radians","stop","Smile","tonguePosition","isStatic","id","LEFT_EYE_POSITION","HEAD_SIZE","RIGHT_EYE_POSITION","SMILE_POSITION","Eyes","showPupils","SmileyFace","SmileyFacePage","useState","debug","setDebug","canvasOptions","clearOnDraw","onClick","d","options","className","colors","angleMode","DEGREES","angle","constrain","Command","command","renderContext","useContext","commandIndex","useRef","useEffect","clear","handleValueOrFunction","values","returnValue","value","handleCommonProps","props","applyProp","propName","Array","PushPop","children","push","useCallback","pop","Debug","ctx","frameRateHistory","displayDebugInfo","fr","Math","avgFr","total","text","P5RenderContext","createContext","RenderContextProvider","step","p5Instance","defineCommandFactory","getOptions","api","defineCommand","rootP5Instance","Setup","SETUP","Draw","DRAW","p5","P5Context","useP5","context","root","draw","useDraw","DEFAULT_OPTIONS","frameRate","P5","setP5Instance","__ready","commands","setTimeout","getCommands","key","idx","handler","index","c","EMPTY_ARRAY","Object","Layer","autoClear","blendMode","opacity","filters","applyFunction","layerImage","setLayerImage","pg","applyCallbacks","applyLayer","doApply","content","contentToApply","copyParams","cb","applyFilters","filter","applyAutoClear","createLayer","console","Mask","mask","layer","parentLayer","parentImg","Canvas","renderer","rp","canvasContainerRef","canvas","ref","Rectangle","FullCanvasRectangle","LinearGradient","params","angleInDegrees","endVectorAngle","startVector","endVector","gradient","i","Body","model","_model","objectState","setObjectState","state","current","Arc","Background","color","Circle","Line","from","to"],"mappings":"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","file":"static/js/smiley.page.d8496562.chunk.js","sourcesContent":["import React, { useMemo } from 'react';\r\nimport { Circle } from 'p5-react';\r\n\r\nconst generateCircleContraint = (p, radius, position) => {\r\n    const circle = p.createVector(position.x, position.y);\r\n    const result = p.createVector(\r\n        p.map(p.mouseX, 0, p.width, circle.x - radius, circle.x + radius),\r\n        p.map(p.mouseY, 0, p.height, circle.y - radius, circle.y + radius)\r\n    );\r\n    const isInBounds = p.dist(result.x, result.y, circle.x, circle.y) < radius;\r\n\r\n    if (!isInBounds) {\r\n        result.sub(circle);\r\n        result.setMag(radius);\r\n        result.add(circle);\r\n    }\r\n    return result;\r\n};\r\n\r\nexport function Eye({ position = { x: 0, y: 0 }, size = 100, showPupil }) {\r\n    const EYEBALL_SIZE = size;\r\n    const PUPIL_SIZE = size / 3;\r\n\r\n    const handlePupilPosition = useMemo(() => {\r\n        const getConstraint = p => {\r\n            let { x, y } = position;\r\n            if (typeof x === 'function') x = x(p);\r\n            if (typeof y === 'function') y = y(p);\r\n            return generateCircleContraint(\r\n                p,\r\n                EYEBALL_SIZE / 2,\r\n                p.createVector(x, y)\r\n            );\r\n        };\r\n\r\n        return {\r\n            x: p => getConstraint(p).x,\r\n            y: p => getConstraint(p).y,\r\n        };\r\n    }, [EYEBALL_SIZE, position]);\r\n    return (\r\n        <>\r\n            <Circle {...position} size={EYEBALL_SIZE} fill={255} noStroke />\r\n            {showPupil && (\r\n                <Circle\r\n                    {...handlePupilPosition}\r\n                    size={PUPIL_SIZE}\r\n                    fill={0}\r\n                    noStroke\r\n                />\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","import React, { useMemo } from 'react';\r\nimport { Layer, Mask, Arc, Circle } from 'p5-react';\r\n\r\nconst Mouth = ({ position }) => (\r\n    <Arc\r\n        {...position}\r\n        width={230}\r\n        height={230}\r\n        fill=\"#947\"\r\n        start={p => p.radians(0)}\r\n        stop={p => p.radians(180)}\r\n        noStroke\r\n    />\r\n);\r\n\r\nexport function Smile({ position }) {\r\n    const tonguePosition = useMemo(\r\n        p => ({\r\n            x: p => {\r\n                let { x } = position;\r\n                if (typeof x === 'function') x = x(p);\r\n                return x - 50;\r\n            },\r\n            y: p => {\r\n                let { y } = position;\r\n                if (typeof y === 'function') y = y(p);\r\n                return y + 100;\r\n            },\r\n        }),\r\n        [position]\r\n    );\r\n    return (\r\n        <Layer isStatic id=\"smile\">\r\n            <Mouth position={position} />\r\n            <Circle {...tonguePosition} size={150} fill=\"#fad\" noStroke />\r\n            <Mask id=\"smile mask\">\r\n                <Mouth position={position} />\r\n            </Mask>\r\n        </Layer>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { Eye } from './Eye';\r\nimport { Circle, Layer, Mask } from 'p5-react';\r\nimport { Smile } from './Smile';\r\n\r\nconst HEAD_SIZE = 300;\r\nconst EYE_SIZE = 80;\r\nconst LEFT_EYE_POSITION = {\r\n    x: p => p.width / 2 - HEAD_SIZE / 4,\r\n    y: 200,\r\n};\r\n\r\nconst RIGHT_EYE_POSITION = {\r\n    x: p => p.width / 2 + HEAD_SIZE / 4,\r\n    y: 200,\r\n};\r\nconst SMILE_POSITION = {\r\n    x: p => p.width / 2,\r\n    y: p => p.height / 2 + 10,\r\n};\r\n\r\nconst Eyes = ({ showPupils }) => (\r\n    <>\r\n        <Eye\r\n            size={EYE_SIZE}\r\n            position={LEFT_EYE_POSITION}\r\n            showPupil={showPupils}\r\n        />\r\n        <Eye\r\n            size={EYE_SIZE}\r\n            position={RIGHT_EYE_POSITION}\r\n            showPupil={showPupils}\r\n        />\r\n    </>\r\n);\r\n\r\nexport function SmileyFace() {\r\n    return (\r\n        <Layer>\r\n            <Circle\r\n                x={p => p.width / 2}\r\n                y={p => p.height / 2}\r\n                size={HEAD_SIZE}\r\n                fill={[245, 225, 120]}\r\n                noStroke\r\n            />\r\n            <Layer>\r\n                <Mask>\r\n                    <Eyes showPupils={false} />\r\n                </Mask>\r\n                <Eyes showPupils={true} />\r\n            </Layer>\r\n            <Smile position={SMILE_POSITION} />\r\n        </Layer>\r\n    );\r\n}\r\n","import React, { useState, useMemo } from 'react';\r\nimport { P5, Canvas, Setup, Draw, LinearGradient } from 'p5-react';\r\nimport { SmileyFace } from '../components/SmileyFace';\r\n\r\nexport default function SmileyFacePage() {\r\n    const [debug, setDebug] = useState(false);\r\n    const canvasOptions = useMemo(\r\n        () => ({\r\n            clearOnDraw: true,\r\n            debug,\r\n            // frameRate: 1,\r\n        }),\r\n        [debug]\r\n    );\r\n    const toggleDebug = () => setDebug(d => !d);\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                <button onClick={toggleDebug}>\r\n                    DEBUG: {debug ? 'ON' : 'OFF'}\r\n                </button>\r\n            </div>\r\n            <P5 options={canvasOptions} className=\"canvas\">\r\n                <Setup>\r\n                    <Canvas width={500} height={500} className=\"canvas\" />\r\n                </Setup>\r\n                <Draw>\r\n                    <LinearGradient\r\n                        colors={[\r\n                            [100, 200, 255],\r\n                            p => p.map(p.mouseY, 0, p.height, 255, 0),\r\n                            [255, 200, 255],\r\n                        ]}\r\n                        angleMode={p => p.DEGREES}\r\n                        angle={p =>\r\n                            p.constrain(\r\n                                p.map(p.mouseX, 0, p.width, 0, 360),\r\n                                0,\r\n                                360\r\n                            )\r\n                        }\r\n                    />\r\n                    <SmileyFace />\r\n                </Draw>\r\n            </P5>\r\n        </>\r\n    );\r\n}\r\n","import { useContext, useRef, useEffect } from 'react';\r\nimport { P5RenderContext } from './RenderContext';\r\n\r\nexport const Command = ({ command, p }) => {\r\n    const renderContext = useContext(P5RenderContext);\r\n    const commandIndex = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const clear = renderContext.defineCommand(\r\n            command,\r\n            () => p || renderContext.p5Instance,\r\n            commandIndex.current\r\n        );\r\n        return () => {\r\n            commandIndex.current = clear();\r\n        };\r\n    }, [command, p, renderContext]);\r\n    return null;\r\n};\r\n","export const handleValueOrFunction = (p, ...values) => {\r\n    const returnValue = values.map(value =>\r\n        typeof value === 'function' ? value(p) : value\r\n    );\r\n\r\n    if (returnValue.length <= 1) return returnValue[0];\r\n    return returnValue;\r\n};\r\n","import { handleValueOrFunction } from './handleValueOrFunction';\r\n\r\nexport function handleCommonProps(props, p) {\r\n    const applyProp = propName => {\r\n        if (!props.hasOwnProperty(propName)) return;\r\n        const value = handleValueOrFunction(p, props[propName]);\r\n\r\n        if (Array.isArray(value)) p[propName](...value);\r\n        else p[propName](value);\r\n    };\r\n\r\n    if (props.noFill) p.noFill();\r\n    if (props.noStroke) p.noStroke();\r\n\r\n    applyProp('ellipseMode');\r\n    applyProp('rectMode');\r\n    applyProp('angleMode');\r\n    applyProp('colorMode');\r\n\r\n    applyProp('fill');\r\n    applyProp('stroke');\r\n\r\n    applyProp('strokeJoin');\r\n    applyProp('strokeCap');\r\n    applyProp('strokeWeight');\r\n\r\n    applyProp('translate');\r\n    applyProp('rotate');\r\n    applyProp('scale');\r\n    applyProp('shearX');\r\n    applyProp('shearY');\r\n    applyProp('applyMatrix');\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport { Command } from './Command';\r\nimport { handleCommonProps } from './utils/handleCommonProps';\r\n\r\nexport function PushPop({ children, ...props }) {\r\n    const push = useCallback(\r\n        p => {\r\n            p.push();\r\n            handleCommonProps(props, p);\r\n        },\r\n        [props]\r\n    );\r\n\r\n    const pop = useCallback(p => {\r\n        p.pop();\r\n    }, []);\r\n    return (\r\n        <>\r\n            <Command command={push} />\r\n            {children}\r\n            <Command command={pop} />\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback, useContext, useRef } from 'react';\r\nimport { P5Context } from './P5';\r\nimport { Command } from './Command';\r\nimport { PushPop } from './PushPop';\r\n\r\nexport function Debug() {\r\n    const ctx = useContext(P5Context);\r\n    const frameRateHistory = useRef([]);\r\n\r\n    const displayDebugInfo = useCallback(\r\n        p => {\r\n            p.fill(0, 80);\r\n            p.noStroke();\r\n            p.rect(0, 0, 185, 95);\r\n\r\n            p.fill(255);\r\n            p.textFont('Courier');\r\n            p.textLeading(20);\r\n            const fr = Math.round(p.frameRate());\r\n            const avgFr =\r\n                frameRateHistory.current.reduce(\r\n                    (total, curr) => total + curr,\r\n                    0\r\n                ) / frameRateHistory.current.length;\r\n            frameRateHistory.current.push(fr);\r\n            if (fr > 200) fr.shift();\r\n            const text = `Current frame rate: ${fr}\r\nAverage frame rate: ${Math.round(avgFr)}\r\nSetup commands: ${ctx.getCommands().setup.length}\r\nDraw commands: ${ctx.getCommands().draw.length}\r\n        `;\r\n            p.text(text, 8, 18);\r\n        },\r\n        [ctx]\r\n    );\r\n\r\n    return (\r\n        <PushPop>\r\n            <Command command={displayDebugInfo} />\r\n        </PushPop>\r\n    );\r\n}\r\n","import React, { createContext, useContext } from 'react';\r\nimport { Debug } from './Debug';\r\nimport { SETUP, DRAW, P5Context } from './P5';\r\nexport const P5RenderContext = createContext(null);\r\n\r\nexport const RenderContextProvider = ({ step, children }) => {\r\n    const { p5Instance, defineCommandFactory, getOptions } = useContext(\r\n        P5Context\r\n    );\r\n    const api = {\r\n        defineCommand: defineCommandFactory(step),\r\n        rootP5Instance: p5Instance,\r\n        p5Instance,\r\n        getOptions,\r\n    };\r\n\r\n    if (!p5Instance) return null;\r\n\r\n    return (\r\n        <P5RenderContext.Provider value={api}>\r\n            {children}\r\n        </P5RenderContext.Provider>\r\n    );\r\n};\r\n\r\nexport const Setup = ({ children }) => {\r\n    return (\r\n        <RenderContextProvider step={SETUP}>{children}</RenderContextProvider>\r\n    );\r\n};\r\nexport const Draw = ({ children }) => {\r\n    const { getOptions } = useContext(P5Context);\r\n    return (\r\n        <RenderContextProvider step={DRAW}>\r\n            {children}\r\n            {getOptions().debug && <Debug />}\r\n        </RenderContextProvider>\r\n    );\r\n};\r\n","import React, {\r\n    useRef,\r\n    useMemo,\r\n    useState,\r\n    useEffect,\r\n    createContext,\r\n    useContext,\r\n} from 'react';\r\nimport p5 from 'p5';\r\nimport { P5RenderContext } from './RenderContext';\r\n\r\np5.disableFriendlyErrors = true;\r\nexport const SETUP = 'setup';\r\nexport const DRAW = 'draw';\r\nexport const PRELOAD = 'preload';\r\n\r\nexport const P5Context = createContext(null);\r\n\r\nexport const useP5 = () => {\r\n    const context = useContext(P5RenderContext);\r\n    return {\r\n        p: context.p5Instance,\r\n        root: context.rootP5Instance,\r\n        draw: context.defineCommand,\r\n    };\r\n};\r\n\r\nexport const useDraw = command => {\r\n    const { draw } = useP5();\r\n\r\n    useEffect(() => {\r\n        const clear = draw(command);\r\n        return () => clear();\r\n    }, [draw, command]);\r\n};\r\n\r\nconst DEFAULT_OPTIONS = {\r\n    clearOnDraw: false,\r\n    frameRate: 60,\r\n    debug: false,\r\n};\r\n\r\nexport const P5 = ({ options, children, ...props }) => {\r\n    const [p5Instance, setP5Instance] = useState(null);\r\n    const __ready = useRef(false);\r\n    const canvasOptions = useMemo(() => ({ ...DEFAULT_OPTIONS, ...options }), [\r\n        options,\r\n    ]);\r\n    const commands = useRef({\r\n        [SETUP]: [],\r\n        [DRAW]: [],\r\n        [PRELOAD]: [],\r\n    });\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            if (p5Instance) p5Instance.remove();\r\n        };\r\n    }, [p5Instance]);\r\n\r\n    useEffect(() => {\r\n        if (!p5Instance) {\r\n            setP5Instance(\r\n                new p5(p => {\r\n                    p.__id = 'ROOT';\r\n\r\n                    p.setup = () => {\r\n                        p.frameRate(canvasOptions.frameRate);\r\n                        // Basically I don't understand why I need to do this...\r\n                        // When Loading the component containing the sketch asynchronously via React.lazy(),\r\n                        // the setup function is executed before the <Commands /> inside <Setup /> had time to define the commands\r\n                        // There is probably a better workaround, but this will do for now...\r\n                        setTimeout(() => {\r\n                            commands.current[SETUP].forEach(command =>\r\n                                command()\r\n                            );\r\n                            __ready.current = true;\r\n                        });\r\n                    };\r\n\r\n                    p.draw = () => {\r\n                        if (__ready.current !== true) return;\r\n                        if (canvasOptions.clearOnDraw) {\r\n                            p.clear();\r\n                        }\r\n                        commands.current[DRAW].forEach(command => {\r\n                            command();\r\n                        });\r\n                    };\r\n                })\r\n            );\r\n        }\r\n    }, [canvasOptions.clearOnDraw, canvasOptions.frameRate, p5Instance]);\r\n\r\n    const api = {\r\n        p5Instance,\r\n        getOptions: () => canvasOptions,\r\n        getCommands: () => commands.current,\r\n        defineCommandFactory: key => (command, ctx = p5Instance, idx) => {\r\n            if (typeof idx !== 'number') {\r\n                idx = commands.current[key].length;\r\n            }\r\n\r\n            const handler = () => {\r\n                return command(typeof ctx === 'function' ? ctx() : ctx);\r\n            };\r\n            handler.__type = command.__type;\r\n            if (commands.current[key].length <= 0) {\r\n                commands.current[key].push(handler);\r\n            } else {\r\n                commands.current[key].splice(idx, 0, handler);\r\n            }\r\n            return () => {\r\n                const index = commands.current[key].indexOf(handler);\r\n                commands.current[key] = commands.current[key].filter(\r\n                    c => c !== handler\r\n                );\r\n                return index;\r\n            };\r\n        },\r\n    };\r\n\r\n    return <P5Context.Provider value={api}>{children}</P5Context.Provider>;\r\n};\r\n","import React, {\r\n    useState,\r\n    useEffect,\r\n    useRef,\r\n    useContext,\r\n    useCallback,\r\n} from 'react';\r\nimport { Command } from './Command';\r\nimport { P5RenderContext } from './RenderContext';\r\nimport { handleValueOrFunction } from './utils/handleValueOrFunction';\r\nconst EMPTY_ARRAY = Object.freeze([]);\r\n\r\nexport function Layer({\r\n    autoClear = true,\r\n    children = null,\r\n    blendMode = 'BLEND',\r\n    opacity,\r\n    filters = EMPTY_ARRAY,\r\n    isStatic = false,\r\n    applyFunction,\r\n    x = 0,\r\n    y = 0,\r\n    width = p => p.width,\r\n    height = p => p.height,\r\n    id,\r\n}) {\r\n    const [layerImage, setLayerImage] = useState(null);\r\n    const pg = useRef(null);\r\n    const applyCallbacks = useRef([]);\r\n    const ctx = useContext(P5RenderContext);\r\n\r\n    useEffect(() => {\r\n        if (isStatic) {\r\n            setLayerImage(null);\r\n        }\r\n    }, [children, opacity, blendMode, isStatic]);\r\n\r\n    const api = {\r\n        ...ctx,\r\n        get p5Instance() {\r\n            return pg.current;\r\n        },\r\n    };\r\n\r\n    const applyLayer = useCallback(() => {\r\n        const p = ctx.p5Instance;\r\n        const doApply = content => {\r\n            p.blendMode(p[blendMode]);\r\n            // only tint if needed because it is a costly operation\r\n            if (opacity) {\r\n                p.tint(255, opacity);\r\n            }\r\n            p.image(\r\n                content,\r\n                handleValueOrFunction(p, x),\r\n                handleValueOrFunction(p, y),\r\n                handleValueOrFunction(p, width),\r\n                handleValueOrFunction(p, height)\r\n            );\r\n        };\r\n\r\n        if (layerImage && isStatic) {\r\n            doApply(layerImage);\r\n            return;\r\n        }\r\n        if (!pg.current || pg.current.width <= 0 || pg.current.height <= 0) {\r\n            return;\r\n        }\r\n\r\n        pg.current.mouseX = p.mouseX + handleValueOrFunction(p, x);\r\n        pg.current.mouseY = p.mouseY + handleValueOrFunction(p, y);\r\n\r\n        let contentToApply = pg.current;\r\n\r\n        if (applyCallbacks.current.length > 0) {\r\n            const copyParams = [0, 0, pg.current.width, pg.current.height];\r\n            contentToApply = p.createImage(pg.current.width, pg.current.height);\r\n            contentToApply.copy(pg.current, ...copyParams, ...copyParams);\r\n            applyCallbacks.current.forEach(cb =>\r\n                cb(pg.current, contentToApply)\r\n            );\r\n        }\r\n\r\n        if (applyFunction) applyFunction(pg.current);\r\n        else doApply(contentToApply);\r\n\r\n        if (isStatic) {\r\n            setLayerImage(contentToApply);\r\n        }\r\n    }, [\r\n        ctx.p5Instance,\r\n        layerImage,\r\n        isStatic,\r\n        applyFunction,\r\n        blendMode,\r\n        opacity,\r\n        x,\r\n        y,\r\n        width,\r\n        height,\r\n    ]);\r\n\r\n    const applyFilters = useCallback(() => {\r\n        if (!pg.current) return;\r\n        filters.forEach(filter => {\r\n            if (Array.isArray(filter)) {\r\n                pg.current.filter(...filter);\r\n            } else {\r\n                pg.current.filter(filter);\r\n            }\r\n        });\r\n    }, [filters]);\r\n\r\n    const applyAutoClear = useCallback(() => {\r\n        if (!pg.current) return;\r\n        pg.current.clear();\r\n    }, []);\r\n\r\n    const createLayer = useCallback(\r\n        p => {\r\n            if (!pg.current) {\r\n                pg.current = ctx.rootP5Instance.createGraphics(\r\n                    handleValueOrFunction(ctx.rootP5Instance, width),\r\n                    handleValueOrFunction(ctx.rootP5Instance, height)\r\n                );\r\n                pg.current.on = (event, cb) => {\r\n                    switch (event) {\r\n                        case 'apply':\r\n                            applyCallbacks.current.push(cb);\r\n                            return () => {\r\n                                applyCallbacks.current.splice(\r\n                                    applyCallbacks.current.indexOf(cb),\r\n                                    1\r\n                                );\r\n                            };\r\n                        default:\r\n                            console.error('Unknow layer event', event);\r\n                    }\r\n                };\r\n            }\r\n            pg.current.__isLayer = true;\r\n            pg.current.__id = id;\r\n        },\r\n        [ctx.rootP5Instance, height, id, width]\r\n    );\r\n\r\n    return (\r\n        <P5RenderContext.Provider value={api}>\r\n            <>\r\n                {!layerImage && <Command command={createLayer} />}\r\n                {!layerImage && autoClear && (\r\n                    <Command command={applyAutoClear} />\r\n                )}\r\n                {!layerImage && children}\r\n                {!layerImage && filters.length > 0 && (\r\n                    <Command command={applyFilters} />\r\n                )}\r\n                <Command command={applyLayer} />\r\n            </>\r\n        </P5RenderContext.Provider>\r\n    );\r\n}\r\n","import React, { useRef, useCallback, useContext } from 'react';\r\nimport { P5RenderContext } from './RenderContext';\r\nimport { Layer } from './Layer';\r\n\r\nexport function Mask({ id, children, ...props }) {\r\n    const ctx = useContext(P5RenderContext);\r\n    const mask = useRef(null);\r\n\r\n    const applyFunction = useCallback(\r\n        layer => {\r\n            const apply = (parentLayer, parentImg) => {\r\n                parentImg.mask(layer);\r\n            };\r\n            if (mask.current) mask.current();\r\n            mask.current = ctx.p5Instance.on('apply', apply);\r\n        },\r\n        [ctx.p5Instance]\r\n    );\r\n\r\n    return (\r\n        <Layer id={id} applyFunction={applyFunction} {...props}>\r\n            {children}\r\n        </Layer>\r\n    );\r\n}\r\n","import React, { useRef, useCallback, useContext } from 'react';\r\nimport { Command } from './Command';\r\nimport { P5RenderContext } from './RenderContext';\r\n\r\nexport function Canvas({\r\n    width,\r\n    height,\r\n    renderer = 'P2D',\r\n    children,\r\n    ...props\r\n}) {\r\n    const { rootP5Instance: rp } = useContext(P5RenderContext);\r\n    const canvasContainerRef = useRef(null);\r\n    const command = useCallback(() => {\r\n        const canvas = rp.createCanvas(width, height, renderer);\r\n        console.log('create canvas');\r\n        canvas.parent(canvasContainerRef.current);\r\n    }, [height, renderer, rp, width]);\r\n\r\n    return (\r\n        <>\r\n            <div ref={canvasContainerRef} {...props} />\r\n            <Command command={command}>{children}</Command>\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport { Command } from '../Command';\r\nimport { handleCommonProps } from '../utils/handleCommonProps';\r\nimport { handleValueOrFunction } from '../utils/handleValueOrFunction';\r\n\r\nexport function Rectangle({ p, x, y, width, height, children, ...props }) {\r\n    const command = useCallback(\r\n        p => {\r\n            handleCommonProps(props, p);\r\n            p.rect(...handleValueOrFunction(p, x, y, width, height));\r\n        },\r\n        [props, x, y, width, height]\r\n    );\r\n    return (\r\n        <>\r\n            <Command command={command} />\r\n            {children}\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback, useContext } from 'react';\r\nimport { Command } from './Command';\r\nimport { P5RenderContext } from './RenderContext';\r\nimport { Rectangle } from './shapes/Rectangle';\r\nimport { PushPop } from './PushPop';\r\nimport { handleCommonProps } from './utils/handleCommonProps';\r\nimport { handleValueOrFunction } from './utils/handleValueOrFunction';\r\nimport p5 from 'p5';\r\n\r\nconst FullCanvasRectangle = () => (\r\n    <Rectangle\r\n        x={0}\r\n        y={0}\r\n        width={p => p.width}\r\n        height={p => p.height}\r\n        noStroke\r\n    />\r\n);\r\nexport function LinearGradient({\r\n    x = 0,\r\n    y = 0,\r\n    width,\r\n    height,\r\n    colors = ['black', 'white'],\r\n    angle,\r\n    angleMode,\r\n    children,\r\n    ...props\r\n}) {\r\n    const { rootP5Instance: rp } = useContext(P5RenderContext);\r\n\r\n    const command = useCallback(\r\n        p => {\r\n            handleCommonProps(props, p);\r\n            const params = {\r\n                x: handleValueOrFunction(rp, x),\r\n                y: handleValueOrFunction(rp, y),\r\n                width: handleValueOrFunction(rp, width) || p.width,\r\n                height: handleValueOrFunction(rp, height) || p.height,\r\n                angle: handleValueOrFunction(rp, angle) || 0,\r\n                angleMode: handleValueOrFunction(rp, angleMode) || p.RADIANS,\r\n                colors: handleValueOrFunction(rp, ...colors),\r\n            };\r\n\r\n            if (params.angleMode !== p.RADIANS) {\r\n                params.angle = p.radians(params.angle);\r\n            }\r\n            p.push();\r\n            p.angleMode(p.DEGREES);\r\n            let angleInDegrees = p.degrees(params.angle) % 360;\r\n            let endVectorAngle = p.degrees(params.angle) % 180;\r\n\r\n            if (endVectorAngle > 45 && endVectorAngle <= 90) {\r\n                endVectorAngle = 90 - endVectorAngle;\r\n            } else if (endVectorAngle > 90 && endVectorAngle <= 135) {\r\n                endVectorAngle -= 90;\r\n            } else if (endVectorAngle > 135 && endVectorAngle <= 180) {\r\n                endVectorAngle = 90 - (endVectorAngle - 90);\r\n            }\r\n\r\n            const startVector = p.createVector(params.x, params.y);\r\n            const endVector = p5.Vector.fromAngle(params.angle);\r\n\r\n            endVector.setMag(params.width / p.sin(90 - endVectorAngle));\r\n            if (angleInDegrees > 270) {\r\n                startVector.y += params.height;\r\n                endVector.y += params.height;\r\n            } else if (angleInDegrees > 180) {\r\n                startVector.x += params.width;\r\n                endVector.x += params.width;\r\n                startVector.y += params.height;\r\n                endVector.y += params.height;\r\n            } else if (angleInDegrees > 90) {\r\n                startVector.x += params.width;\r\n                endVector.x += params.width;\r\n            }\r\n            p.pop();\r\n            const gradient = p.drawingContext.createLinearGradient(\r\n                startVector.x,\r\n                startVector.y,\r\n                params.x + endVector.x,\r\n                params.y + endVector.y\r\n            );\r\n            params.colors.forEach((color, i) => {\r\n                const stop = i / (params.colors.length - 1);\r\n                gradient.addColorStop(stop, p.color(color).toString());\r\n            });\r\n            p.drawingContext.fillStyle = gradient;\r\n\r\n            // UNCOMMENT TO DEBUG\r\n            // p.push();\r\n            // p.rect(0, 0, p.width, p.height);\r\n            // p.fill(0);\r\n            // p.text(`angle: ${Math.round(p.degrees(params.angle))}`, 15, 15);\r\n            // p.noFill();\r\n            // p.stroke(128);\r\n            // p.rect(params.x, params.y, params.width, params.height);\r\n            // p.rectMode(p.CORNERS);\r\n            // p.stroke(255);\r\n            // p.line(\r\n            //     startVector.x,\r\n            //     startVector.y,\r\n            //     params.x + endVector.x,\r\n            //     params.y + endVector.y\r\n            // );\r\n            // p.pop();\r\n        },\r\n        [props, rp, x, y, width, height, angle, angleMode, colors]\r\n    );\r\n\r\n    return (\r\n        <PushPop>\r\n            <Command command={command} />\r\n            {children || <FullCanvasRectangle />}\r\n        </PushPop>\r\n    );\r\n}\r\n","import React, { useRef, useState, useEffect, useCallback } from 'react';\r\nimport { Command } from './Command';\r\nimport { useP5 } from './P5';\r\n\r\nexport function Body({ model, children }) {\r\n    const { p } = useP5();\r\n    const _model = useRef(null);\r\n    const [objectState, setObjectState] = useState(null);\r\n\r\n    const command = useCallback(\r\n        p => {\r\n            if (objectState) {\r\n                _model.current.update(p);\r\n                setObjectState({ state: _model.current });\r\n            }\r\n        },\r\n        [objectState]\r\n    );\r\n\r\n    useEffect(() => {\r\n        // We need to wait for the next tick before initializing the model\r\n        // This is because it could happend that setup commands such as createCanvas have not been run yet, potentially forwarding wrong values into the model\r\n        if (!_model.current) {\r\n            setTimeout(() => {\r\n                _model.current = model(p, _model.current);\r\n                setObjectState({ state: _model.current });\r\n            });\r\n        } else {\r\n            _model.current = model(p, _model.current);\r\n            setObjectState({ state: _model.current });\r\n        }\r\n    }, [model, p]);\r\n\r\n    return (\r\n        <>\r\n            <Command command={command}></Command>\r\n            {objectState && children(objectState.state)}\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport { Command } from '../Command';\r\nimport { handleCommonProps } from '../utils/handleCommonProps';\r\nimport { handleValueOrFunction } from '../utils/handleValueOrFunction';\r\n\r\nexport function Arc({\r\n    p,\r\n    x,\r\n    y,\r\n    height,\r\n    width,\r\n    start,\r\n    stop,\r\n    children,\r\n    ...props\r\n}) {\r\n    const command = useCallback(\r\n        p => {\r\n            handleCommonProps(props, p);\r\n            p.arc(\r\n                ...handleValueOrFunction(p, x, y, width, height, start, stop)\r\n            );\r\n        },\r\n        [props, x, y, width, height, start, stop]\r\n    );\r\n    return (\r\n        <>\r\n            <Command command={command} />\r\n            {children}\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport { Command } from '../Command';\r\nimport { handleValueOrFunction } from '../utils/handleValueOrFunction';\r\n\r\nexport function Background({ color, children, ...props }) {\r\n    const command = useCallback(\r\n        p => {\r\n            p.background(handleValueOrFunction(p, color));\r\n        },\r\n        [color]\r\n    );\r\n    return (\r\n        <>\r\n            <Command command={command} />\r\n            {children}\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport { Command } from '../Command';\r\nimport { handleCommonProps } from '../utils/handleCommonProps';\r\nimport { handleValueOrFunction } from '../utils/handleValueOrFunction';\r\n\r\nexport function Circle({ p, x, y, size, children, ...props }) {\r\n    const command = useCallback(\r\n        p => {\r\n            handleCommonProps(props, p);\r\n            p.circle(...handleValueOrFunction(p, x, y, size));\r\n        },\r\n        [props, x, y, size]\r\n    );\r\n\r\n    return (\r\n        <>\r\n            <Command command={command} />\r\n            {children}\r\n        </>\r\n    );\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport { Command } from '../Command';\r\nimport { handleCommonProps } from '../utils/handleCommonProps';\r\nimport { handleValueOrFunction } from '../utils/handleValueOrFunction';\r\n\r\nexport function Line({ p, from, to, children, ...props }) {\r\n    const command = useCallback(\r\n        p => {\r\n            handleCommonProps(props, p);\r\n            p.line(...handleValueOrFunction(p, from, to).flat());\r\n        },\r\n        [props, from, to]\r\n    );\r\n    return (\r\n        <>\r\n            <Command command={command} />\r\n            {children}\r\n        </>\r\n    );\r\n}\r\n"],"sourceRoot":""}