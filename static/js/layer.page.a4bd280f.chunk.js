(this["webpackJsonpp5-react-example"]=this["webpackJsonpp5-react-example"]||[]).push([[3],{100:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(35),c=n(0),a=n.n(c),u=n(97),o=function(){var e=Object(c.useRef)(0);return Object(u.m)((function(t){e.current++,e.current>t.height&&(e.current=0)})),a.a.createElement(a.a.Fragment,null,a.a.createElement(u.b,{color:0}),a.a.createElement(u.h,{from:function(t){return[0,e.current]},to:function(t){return[t.width,e.current]},stroke:[255,0,0],strokeWeight:2}),a.a.createElement(u.g,{id:"layer",autoClear:!1},a.a.createElement(u.e,{x:function(e){return e.mouseX},y:function(e){return e.mouseY},size:20,fill:255,noStroke:!0})))};function i(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],i=t[1],l=Object(c.useMemo)((function(){return{clearOnDraw:!0,debug:n}}),[n]);return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){return i((function(e){return!e}))}},"DEBUG: ",n?"ON":"OFF")),a.a.createElement(u.k,{options:l,className:"canvas"},a.a.createElement(u.l,null,a.a.createElement(u.d,{width:500,height:500,className:"canvas"}),a.a.createElement(u.b,{color:0})),a.a.createElement(u.f,null,a.a.createElement(o,null))))}},97:function(e,t,n){"use strict";n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return X})),n.d(t,"c",(function(){return G})),n.d(t,"d",(function(){return _})),n.d(t,"e",(function(){return Y})),n.d(t,"f",(function(){return C})),n.d(t,"g",(function(){return M})),n.d(t,"h",(function(){return J})),n.d(t,"i",(function(){return z})),n.d(t,"j",(function(){return D})),n.d(t,"k",(function(){return A})),n.d(t,"l",(function(){return w})),n.d(t,"m",(function(){return P}));var r=n(0),c=n.n(r),a=n(98),u=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,c=!1,a=void 0;try{for(var u,o=e[Symbol.iterator]();!(r=(u=o.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(i){c=!0,a=i}finally{try{r||null==o.return||o.return()}finally{if(c)throw a}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.command,n=e.p,c=Object(r.useContext)(j),a=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=c.defineCommand(t,(function(){return n||c.p5Instance}),a.current);return function(){a.current=e()}}),[t,n,c]),null},g=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var c=n.map((function(t){return"function"===typeof t?t(e):t}));return c.length<=1?c[0]:c};function v(e,t){var n=function(n){if(e.hasOwnProperty(n)){var r=g(t,e[n]);Array.isArray(r)?t[n].apply(t,m(r)):t[n](r)}};e.noFill&&t.noFill(),e.noStroke&&t.noStroke(),n("ellipseMode"),n("rectMode"),n("angleMode"),n("colorMode"),n("fill"),n("stroke"),n("strokeJoin"),n("strokeCap"),n("strokeWeight"),n("translate"),n("rotate"),n("scale"),n("shearX"),n("shearY"),n("applyMatrix")}function y(e){var t=e.children,n=s(e,["children"]),a=Object(r.useCallback)((function(e){e.push(),v(n,e)}),[n]),u=Object(r.useCallback)((function(e){e.pop()}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:a}),t,c.a.createElement(b,{command:u}))}function O(){var e=Object(r.useContext)(S),t=Object(r.useRef)([]),n=Object(r.useCallback)((function(n){n.fill(0,80),n.noStroke(),n.rect(0,0,185,95),n.fill(255),n.textFont("Courier"),n.textLeading(20);var r=Math.round(n.frameRate()),c=t.current.reduce((function(e,t){return e+t}),0)/t.current.length;t.current.push(r),r>200&&r.shift();var a="Current frame rate: ".concat(r,"\nAverage frame rate: ").concat(Math.round(c),"\nSetup commands: ").concat(e.getCommands().setup.length,"\nDraw commands: ").concat(e.getCommands().draw.length,"\n        ");n.text(a,8,18)}),[e]);return c.a.createElement(y,null,c.a.createElement(b,{command:n}))}var j=Object(r.createContext)(null),E=function(e){var t=e.step,n=e.children,a=Object(r.useContext)(S),u=a.p5Instance,o=a.defineCommandFactory,i=a.getOptions,l={defineCommand:o(t),rootP5Instance:u,p5Instance:u,getOptions:i};return u?c.a.createElement(j.Provider,{value:l},n):null},w=function(e){var t=e.children;return c.a.createElement(E,{step:x},t)},C=function(e){var t=e.children,n=Object(r.useContext)(S).getOptions;return c.a.createElement(E,{step:k},t,n().debug&&c.a.createElement(O,null))};u.a.disableFriendlyErrors=!0;var x="setup",k="draw",S=Object(r.createContext)(null),I=function(){var e=Object(r.useContext)(j);return{p:e.p5Instance,root:e.rootP5Instance,draw:e.defineCommand}},P=function(e){var t=I().draw;Object(r.useEffect)((function(){var n=t(e);return function(){return n()}}),[t,e])},F={clearOnDraw:!1,frameRate:60,debug:!1},A=function(e){var t,n=e.options,a=e.children,i=(s(e,["options","children"]),d(Object(r.useState)(null),2)),l=i[0],m=i[1],h=Object(r.useRef)(!1),p=Object(r.useMemo)((function(){return f({},F,{},n)}),[n]),b=Object(r.useRef)((o(t={},x,[]),o(t,k,[]),o(t,"preload",[]),t));Object(r.useEffect)((function(){return function(){l&&l.remove()}}),[l]),Object(r.useEffect)((function(){l||m(new u.a((function(e){e.__id="ROOT",e.setup=function(){e.frameRate(p.frameRate),setTimeout((function(){b.current[x].forEach((function(e){return e()})),h.current=!0}))},e.draw=function(){!0===h.current&&(p.clearOnDraw&&e.clear(),b.current[k].forEach((function(e){e()})))}})))}),[p.clearOnDraw,p.frameRate,l]);var g={p5Instance:l,getOptions:function(){return p},getCommands:function(){return b.current},defineCommandFactory:function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,r=arguments.length>2?arguments[2]:void 0;"number"!==typeof r&&(r=b.current[e].length);var c=function(){return t("function"===typeof n?n():n)};return c.__type=t.__type,b.current[e].length<=0?b.current[e].push(c):b.current[e].splice(r,0,c),function(){var t=b.current[e].indexOf(c);return b.current[e]=b.current[e].filter((function(e){return e!==c})),t}}}};return c.a.createElement(S.Provider,{value:g},a)},R=Object.freeze([]);function M(e){var t=e.autoClear,n=void 0===t||t,a=e.children,u=void 0===a?null:a,o=e.blendMode,i=void 0===o?"BLEND":o,l=e.opacity,s=e.filters,h=void 0===s?R:s,p=e.isStatic,v=void 0!==p&&p,y=e.applyFunction,O=e.x,E=void 0===O?0:O,w=e.y,C=void 0===w?0:w,x=e.width,k=void 0===x?function(e){return e.width}:x,S=e.height,I=void 0===S?function(e){return e.height}:S,P=e.id,F=d(Object(r.useState)(null),2),A=F[0],M=F[1],D=Object(r.useRef)(null),_=Object(r.useRef)([]),N=Object(r.useContext)(j);Object(r.useEffect)((function(){v&&M(null)}),[u,l,i,v]);var T=f({},N,{get p5Instance(){return D.current}}),z=Object(r.useCallback)((function(){var e=N.p5Instance,t=function(t){e.blendMode(e[i]),l&&e.tint(255,l),e.image(t,g(e,E),g(e,C),g(e,k),g(e,I))};if(A&&v)t(A);else if(!(!D.current||D.current.width<=0||D.current.height<=0)){D.current.mouseX=e.mouseX+g(e,E),D.current.mouseY=e.mouseY+g(e,C);var n=D.current;if(_.current.length>0){var r,c=[0,0,D.current.width,D.current.height];(r=n=e.createImage(D.current.width,D.current.height)).copy.apply(r,[D.current].concat(c,c)),_.current.forEach((function(e){return e(D.current,n)}))}y?y(D.current):t(n),v&&M(n)}}),[N.p5Instance,A,v,y,i,l,E,C,k,I]),G=Object(r.useCallback)((function(){D.current&&h.forEach((function(e){var t;Array.isArray(e)?(t=D.current).filter.apply(t,m(e)):D.current.filter(e)}))}),[h]),L=Object(r.useCallback)((function(){D.current&&D.current.clear()}),[]),X=Object(r.useCallback)((function(e){D.current||(D.current=N.rootP5Instance.createGraphics(g(N.rootP5Instance,k),g(N.rootP5Instance,I)),D.current.on=function(e,t){switch(e){case"apply":return _.current.push(t),function(){_.current.splice(_.current.indexOf(t),1)};default:console.error("Unknow layer event",e)}}),D.current.__isLayer=!0,D.current.__id=P}),[N.rootP5Instance,I,P,k]);return c.a.createElement(j.Provider,{value:T},c.a.createElement(c.a.Fragment,null,!A&&c.a.createElement(b,{command:X}),!A&&n&&c.a.createElement(b,{command:L}),!A&&u,!A&&h.length>0&&c.a.createElement(b,{command:G}),c.a.createElement(b,{command:z})))}function D(e){var t=e.id,n=e.children,a=s(e,["id","children"]),u=Object(r.useContext)(j),o=Object(r.useRef)(null),l=Object(r.useCallback)((function(e){o.current&&o.current(),o.current=u.p5Instance.on("apply",(function(t,n){n.mask(e)}))}),[u.p5Instance]);return c.a.createElement(M,i({id:t,applyFunction:l},a),n)}function _(e){var t=e.width,n=e.height,a=e.renderer,u=void 0===a?"P2D":a,o=e.children,l=s(e,["width","height","renderer","children"]),f=Object(r.useContext)(j).rootP5Instance,d=Object(r.useRef)(null),m=Object(r.useCallback)((function(){var e=f.createCanvas(t,n,u);console.log("create canvas"),e.parent(d.current)}),[n,u,f,t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",i({ref:d},l)),c.a.createElement(b,{command:m},o))}function N(e){e.p;var t=e.x,n=e.y,a=e.width,u=e.height,o=e.children,i=s(e,["p","x","y","width","height","children"]),l=Object(r.useCallback)((function(e){v(i,e),e.rect.apply(e,m(g(e,t,n,a,u)))}),[i,t,n,a,u]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:l}),o)}var T=function(){return c.a.createElement(N,{x:0,y:0,width:function(e){return e.width},height:function(e){return e.height},noStroke:!0})};function z(e){var t=e.x,n=void 0===t?0:t,a=e.y,o=void 0===a?0:a,i=e.width,l=e.height,f=e.colors,d=void 0===f?["black","white"]:f,h=e.angle,p=e.angleMode,O=e.children,E=s(e,["x","y","width","height","colors","angle","angleMode","children"]),w=Object(r.useContext)(j).rootP5Instance,C=Object(r.useCallback)((function(e){v(E,e);var t={x:g(w,n),y:g(w,o),width:g(w,i)||e.width,height:g(w,l)||e.height,angle:g(w,h)||0,angleMode:g(w,p)||e.RADIANS,colors:g.apply(void 0,[w].concat(m(d)))};t.angleMode!==e.RADIANS&&(t.angle=e.radians(t.angle)),e.push(),e.angleMode(e.DEGREES);var r=e.degrees(t.angle)%360,c=e.degrees(t.angle)%180;c>45&&c<=90?c=90-c:c>90&&c<=135?c-=90:c>135&&c<=180&&(c=90-(c-90));var a=e.createVector(t.x,t.y),f=u.a.Vector.fromAngle(t.angle);f.setMag(t.width/e.sin(90-c)),r>270?(a.y+=t.height,f.y+=t.height):r>180?(a.x+=t.width,f.x+=t.width,a.y+=t.height,f.y+=t.height):r>90&&(a.x+=t.width,f.x+=t.width),e.pop();var s=e.drawingContext.createLinearGradient(a.x,a.y,t.x+f.x,t.y+f.y);t.colors.forEach((function(n,r){var c=r/(t.colors.length-1);s.addColorStop(c,e.color(n).toString())})),e.drawingContext.fillStyle=s}),[E,w,n,o,i,l,h,p,d]);return c.a.createElement(y,null,c.a.createElement(b,{command:C}),O||c.a.createElement(T,null))}function G(e){var t=e.model,n=e.children,a=I().p,u=Object(r.useRef)(null),o=d(Object(r.useState)(null),2),i=o[0],l=o[1],f=Object(r.useCallback)((function(e){i&&(u.current.update(e),l({state:u.current}))}),[i]);return Object(r.useEffect)((function(){u.current?(u.current=t(a,u.current),l({state:u.current})):setTimeout((function(){u.current=t(a,u.current),l({state:u.current})}))}),[t,a]),c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:f}),i&&n(i.state))}function L(e){e.p;var t=e.x,n=e.y,a=e.height,u=e.width,o=e.start,i=e.stop,l=e.children,f=s(e,["p","x","y","height","width","start","stop","children"]),d=Object(r.useCallback)((function(e){v(f,e),e.arc.apply(e,m(g(e,t,n,u,a,o,i)))}),[f,t,n,u,a,o,i]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:d}),l)}function X(e){var t=e.color,n=e.children,a=(s(e,["color","children"]),Object(r.useCallback)((function(e){e.background(g(e,t))}),[t]));return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:a}),n)}function Y(e){e.p;var t=e.x,n=e.y,a=e.size,u=e.children,o=s(e,["p","x","y","size","children"]),i=Object(r.useCallback)((function(e){v(o,e),e.circle.apply(e,m(g(e,t,n,a)))}),[o,t,n,a]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:i}),u)}function J(e){e.p;var t=e.from,n=e.to,a=e.children,u=s(e,["p","from","to","children"]),o=Object(r.useCallback)((function(e){v(u,e),e.line.apply(e,m(g(e,t,n).flat()))}),[u,t,n]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{command:o}),a)}}}]);
//# sourceMappingURL=layer.page.a4bd280f.chunk.js.map